<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Data</title>

<script src="site_libs/header-attrs-2.18/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="Places_data.html">Sleep &amp; Diseases</a>
</li>
<li>
  <a href="Sleep-and-Social-Factors.html">Sleep &amp; Social factors</a>
</li>
<li>
  <a href="app.html">Survey about sleep</a>
</li>
<li>
  <a href="mailto:&lt;wz2631@cumc.columbia.edu&gt;">
    <span class="fa fa-envelope fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://github.com/jchaicc/final.github.io.git">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="References.html">
    <span class="fa fa-book fa-lg"></span>
     
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Data</h1>

</div>


<div id="data-sources" class="section level2">
<h2>Data Sources</h2>
<ul>
<li><p>The first data set that was used to explore the association
between sleeping and social factors was downloaded from the <a
href="https://www.cdc.gov/nchs/nhanes/index.htm">NHANES</a>
database.</p></li>
<li><p>The second data set was from <a
href="https://www.cdc.gov/sleep/data-and-statistics/adults.html">CDC</a>.</p></li>
</ul>
</div>
<div id="data-processing-and-cleaning" class="section level2">
<h2>Data Processing and Cleaning</h2>
<ul>
<li>For data from the NHANES database: The predictors and the response
variable were from different data base in NHANES. First, the the column
name for these response variables was changed to appropriate names. The
original data included numbers to represent difference levels for each
predictor, specific names was also replaced for each number. Then, the
response variable related to sleeping was from another data base. For
this data set, similar steps was used with dealing with the predictors
data set. All column names was converted to appropriate names, and
character names also replaced the numbers as well. An extra column was
added to the data set:<code>ave_slp_hr</code>, which is the average
sleeping hours per day, by calculating the mean of the weekday and
weekend sleeping hours. For the third step, all empty cells was removed.
Finally, the two cleaned data sets was joined through the patientsâ€™
unique sequence number.</li>
</ul>
<pre class="r"><code>demo=foreign::read.xport(&quot;nhanes/P_DEMO.XPT&quot;) %&gt;%
  janitor::clean_names() %&gt;%
  select(seqn,riagendr,ridageyr,ridreth3,dmdeduc2,indfmpir) %&gt;%
  drop_na() %&gt;%
  rename(gender=riagendr,
         age=ridageyr,
         race=ridreth3,
         education_level=dmdeduc2,
         income_poverty_ratio=indfmpir) %&gt;%
  mutate(gender=case_when(gender==1 ~ &quot;male&quot;,
                          gender==2 ~ &quot;female&quot;)) %&gt;%
  mutate(race=case_when(race==1 ~ &quot;Mexican American&quot;,
                        race==2 ~ &quot;Other Hispanic&quot;,
                        race==3 ~ &quot;Non-Hispanic White&quot;,
                        race==4 ~ &quot;Non-Hispanic Black&quot;,
                        race==6 ~ &quot;Non-Hispanic Asian&quot;,
                        race==7 ~ &quot;Other Race&quot;)) %&gt;%
  mutate(education_level=case_when(education_level==1 ~ &quot;less than 9th grade&quot;,
                                   education_level==2 ~ &quot;9-11th grade&quot;,
                                   education_level==3 ~ &quot;high school graduate&quot;,
                                   education_level==4 ~ &quot;college or AA degree&quot;,
                                   education_level==5 ~ &quot;college graduate or above&quot;,
                                   education_level==7 ~ &quot;refused&quot;,
                                   education_level==9 ~ &quot;don&#39;t know&quot;))


sleep_df=foreign::read.xport(&quot;nhanes/P_SLQ.XPT&quot;) %&gt;%
  janitor::clean_names() %&gt;% 
  select(seqn,slq300,slq310,sld012,slq320,slq330,sld013,slq050,slq120) %&gt;%
  rename(weekday_slp_time=slq300,
         weekday_wake_time=slq310,
         weekday_slp_hr=sld012,
         weekend_slp_time=slq320,
         weekend_wake_time=slq330,
         weekend_slp_hr=sld013,
         trouble_slp=slq050,
         sleepy_freq=slq120
         )              %&gt;%
  filter(weekday_slp_time!=77777 &amp; weekday_slp_time!= 99999) %&gt;%
  filter(weekday_wake_time!=77777 &amp; weekday_wake_time!= 99999) %&gt;%
  filter(weekend_slp_time!=77777 &amp; weekend_slp_time != 99999) %&gt;%
  filter(weekend_wake_time!= 77777 &amp; weekend_wake_time != 99999) %&gt;%
  filter(trouble_slp!=7 &amp; trouble_slp!= 9) %&gt;%
  filter(sleepy_freq!= 7 &amp; sleepy_freq!=9) %&gt;%
  drop_na() %&gt;%
  mutate(trouble_slp=case_when(trouble_slp==1 ~ &quot;yes&quot;,
                               trouble_slp==2 ~ &quot;no&quot;)) %&gt;%
  mutate(sleepy_freq=case_when(sleepy_freq==0 ~ &quot;never&quot;,
                               sleepy_freq==1 ~ &quot;once a month&quot;,
                               sleepy_freq==2 ~ &quot;2-4 per month&quot;,
                               sleepy_freq==3 ~ &quot;5-15 per month&quot;,
                               sleepy_freq==4 ~ &quot;16-30 per month&quot;,
                               ))%&gt;% 
  mutate(ave_slp_hr = (5*weekday_slp_hr + 2*weekend_slp_hr)/7)</code></pre>
<pre class="r"><code>slp_df=inner_join(demo,sleep_df,by=&quot;seqn&quot;) %&gt;%
  na_if(&quot;&quot;) %&gt;%
  na.omit()
write_csv(slp_df, &quot;data/slp_df.csv&quot;)</code></pre>
</div>
<div id="data-description" class="section level2">
<h2>Data Description</h2>
<div id="social-factors-related-to-sleeping-status-data"
class="section level4">
<h4>Social factors related to Sleeping Status Data</h4>
<p>The resulting data file of <code>slp_df</code> contains a single
dataframe with 7665 rows of data on 15 variables, the list below is our
variables of interest:</p>
<ul>
<li><code>seqn</code>. The sequence number of the candidate.</li>
<li><code>gender</code>. Gender of the candidate.</li>
<li><code>age</code>. Age of the candidate.</li>
<li><code>race</code>. Race of the candidate.</li>
<li><code>hour</code>. Time(hour) violation occurred.</li>
<li><code>education_level</code>. The education level of the
candidate.</li>
<li><code>income_poverty_ratio</code>. A ratio to classify poverty and
not poverty. Ratio greater than 1 will be considered as not poverty,
ratio less than 1 will considered as poverty.</li>
<li><code>weekday_slp_time</code>. Sleep time on weekdays or
workdays.</li>
<li><code>weekday_wake_time</code>. Wake time on weekdays and
workdays.</li>
<li><code>weekday_slp_hr</code>. Average sleeping hours on weekdays or
workdays.</li>
<li><code>weekend_slp_time</code>. Sleep time on weekends.</li>
<li><code>weekday_wake_time</code>.Wake time on weekends.</li>
<li><code>weekend_slp_hr</code>. Average sleeping hours on
weekends.</li>
<li><code>trouble_slp</code>. A response on whether telling the doctor
having trouble sleeping.</li>
<li><code>sleepy_freq</code>. Average sleeply times during daytime per
month.</li>
<li><code>ave_slp_hr</code>. Average sleeping hours per day.</li>
</ul>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
